apiVersion: v1
kind: ConfigMap
metadata:
  name: publish-config
data:
  application-yaml: |-
    hedera:
      mirror:
        test:
          acceptance:
            messageTimeout: 60s
            nodeId: 0.0.3
            nodeAddress: testnet
            mirrornodeAddress: hcs.testnet.mirrornode.hedera.com:5600
            operatorid:
            operatorkey:
            existingTopicNum:
            emitBackgroundMessages: true
---
apiVersion: batch/v1
kind: Job
metadata:
  name: hcs-perf-publish-test
spec:
  completions: 1
  parallelism: 1
  template:
    metadata:
      name: hcs-perf-publish-test
    spec:
      restartPolicy: Never
      containers:
        - image: gcr.io/mirrornode/hedera-mirror-test:0.13.0-rc1
          imagePullPolicy: Always
          name: publish-test-img
          env:
            - name: testProfile
              value: "acceptance"
            - name: cucumberFlags
              value: "@PublishOnly"
          volumeMounts:
            - name: publish-config-volume
              mountPath: /usr/etc/hedera-mirror-node/hedera-mirror-test/src/test/resources/application-default.yml
              subPath: application-default.yml
      volumes:
        - name: publish-config-volume
          configMap:
            defaultMode: 0555
            name: publish-config
            items:
              - key: application-yaml
                path: application-default.yml
